@page "/produkt-bearbeiten"
@*@page "/produkt-bearbeiten/{id}"*@
@inject DatabaseContext dbContext;

<div class="admin-wrapper">


	<div class="topbar">
		<div class="logo-wrapper">
			<a href="#"><img src="drawable/Logo_BBRZ.png" alt="BBRZ" height="50" /></a>
		</div>
		<h1 class="pagename">Produkt bearbeiten</h1>
		<div class="topbar-btn-wrapper">
			<a class="button-primary logout-btn" href="/"><span>ABMELDEN</span></a>
		</div>
	</div>





    <div class="admin-form-wrapper">
		<div class="dark-box admin-form-box">
			<form>
			
				<p>
					<label>Produkt wählen:</label>
					<select id="prod" @bind="@_catId">
						<option hidden checked></option>
						@foreach (var item in products)
						{
							<option value="@item.KategorieId" onchange="@UpdateCat(); @UpdatePic(); @UpdatePrice(); ">@item.ProduktName</option>
						}
					</select>
					<input placeholder="Neuer Produktname" style="margin-left: 70px;" />
				</p>

			
				<p><label>Kategorie:</label><input value="@_catName" disabled="disabled" /> <input placeholder="Neue Kategorie" style="margin-left: 70px;" /></p>
				
				<p>
					<label>Bild:</label>
					@if (_catPic != null)
					{
						<img height="32px" src="@_catPic"/>
					}
					<select style="margin-left: 200px;">
						
					</select>

				</p>
				<p><label>Preis:</label><input type="text" value="@_prodPrice" disabled="disabled" />&euro; <input type="text" placeholder="Neuer Preis" style="margin-left: 70px;" />&euro;</p>
				

				<p class="right-align"><input type="submit" class="admin-form-btn btn-inactive" value="Senden"/>&nbsp;<input type="submit" class="admin-form-btn" value="Abbrechen" style="margin-right:40px;"/></p>
			</form>

		</div>
	</div>

	
	imageSource
</div>

@code {
	private string imageSource;

	

	

	

	List<Produkt> products = new();

	List<Kategorie> kategories = new();

	int _catId;

	string _catName;

	string _prodPrice;

	string _catPic;

	protected override async Task OnInitializedAsync()
	{
		kategories = await dbContext.AllCategoriesToListAsync();
		products = await dbContext.AllProductsToListAsync();
	}


}

@functions
{

	public string UpdatePrice()
	{
		foreach (var item in products)
		{
			if (_catId.Equals(item.KategorieId))
			{
				return _prodPrice = item.ProduktPreis.ToString("0.00");
			}

		}
		return null;
	}

	public string UpdatePic()
	{
		foreach (var item in products)
		{
			if (_catId.Equals(item.KategorieId))
			{
				return _catPic = item.ProduktBild;
			}

		}
		return null;
	}

	public string UpdateCat()
	{
		foreach (var item in kategories)
		{
			if (_catId.Equals(item.Id))
			{
				return _catName = item.KategorieName;
			}
		}
		return null;
	}
}
